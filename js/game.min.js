function initGame(){var n=document.getElementById("canvas1"),t=n.getContext("2d");game=new Game(t);game.run()}function Game(n){function u(n){for(var t=0;t<n.assets.length;t++)n.assets[t].update(n)}function f(n){n.ctx.clearRect(0,0,this.w,this.h);for(var t=0;t<n.assets.length;t++)n.assets[t].draw(n)}function i(n){t.loopInterval=n;clearInterval(t.timer);t.timer=setInterval(t.loop,t.loopInterval)}function e(n){var t=[];return t.push(new Levels(n)),t.push(new Sprite(n)),t.push(new Gates(n)),t.push(new Stats(n)),t.push(new InfoScreen(n)),t}function o(n){bindEvent(window,"keydown",function(t){t.keyCode===80?n.paused=!n.paused:t.keyCode===189?n.slowDown():t.keyCode===187?n.speedUp():t.keyCode===82&&n.resetGame();for(var i=0;i<n.assets.length;i++)n.assets[i].receiveKey(t.keyCode,n)})}var r=80,t=this;this.ctx=n;this.assets=e(this);this.paused=!1;this.timer=null;this.loopInterval=r;o(t);this.run=function(){t.timer=setInterval(t.loop,t.loopInterval)};this.loop=function(){t.paused||(u(t),f(t))};this.speedUp=function(){t.loopInterval>20&&i(t.loopInterval-20)};this.slowDown=function(){t.loopInterval<140&&i(t.loopInterval+20)};this.fps=function(){return Math.floor(1e3/t.loopInterval)};this.resetGame=function(){t.paused=!1;i(r)}}function Levels(n){var u=5,i,r,t;for(this.x=0,this.y=0,this.w=n.ctx.canvas.width,this.h=n.ctx.canvas.height,this.levelFrames=[],this.bgImageNames=["img/jungle.png","img/inca.png","img/desert.png","img/peru.png"],this.levelIndex=0,this.level=1,this.leveledUp=!1,i=0;i<this.bgImageNames.length;i++)r=new Image,r.src=this.bgImageNames[i],this.levelFrames.push(r);t=this;this.update=function(n){var i=n.assets[3];t.levelIndex<t.levelFrames.length&&i.score>0?t.leveledUp||i.score%u!=0?i.score%u==1&&(t.leveledUp=!1):(t.levelIndex++,t.level++,t.leveledUp=!0,n.assets[4].toast("Level "+t.level,3)):t.levelIndex=0};this.draw=function(n){n.ctx.drawImage(t.levelFrames[t.levelIndex],this.x,this.y)};this.receiveKey=function(n){n===82&&(t.levelIndex=0,t.level=1)}}function Sprite(n){function f(n){i.x=n.canvas.width/2-i.w/2;i.y=n.canvas.height/2-i.h/2}var e=0,o=1,s=2,i,r,t,u;for(this.x=0,this.y=0,this.vy=0,this.w=0,this.h=0,this.imageNames=["img/p1.png","img/p2.png","img/p3.png"],this.imageFrames=[],this.frameIdx=0,this.dead=!1,this.immune=!1,this.started=!1,this.audioFiles=["wav/flap.wav","wav/squelch.wav","wav/fail.wav"],this.audio=[],i=this,t=0;t<this.audioFiles.length;t++)r=document.createElement("audio"),r.type="audio/wav",r.src=this.audioFiles[t],this.audio.push(r),document.body.appendChild(r);for(t=0;t<this.imageNames.length;t++)u=new Image,t===0&&(u.onload=function(){i.w=this.width;i.h=this.height;f(n.ctx)}),u.src=this.imageNames[t],this.imageFrames.push(u);this.update=function(n){this.dead||(this.frameIdx=this.frameIdx===0?1:0);this.started&&(this.y+=this.vy,this.vy++);this.y>=n.ctx.canvas.height-this.h&&(this.vy=0,this.y=n.ctx.canvas.height-this.h)};this.draw=function(n){n.ctx.drawImage(this.imageFrames[this.frameIdx],this.x,this.y)};this.receiveKey=function(n,t){n===70&&this.y>0&&!this.dead?(this.started=!0,this.vy=-10,this.audio[e].play()):n===73?this.immune=!this.immune:n===82&&(this.frameIdx=0,this.dead=!1,this.started=!1,f(t.ctx))};this.hit=function(){this.dead=!0;this.frameIdx=2;this.vy=0;this.audio[o].play();this.audio[s].play()}}function Gates(n){function a(n){for(var r,i=0;i<t;i++)r=s.gateArray[i],h(r,i,n)}function h(n,t,i){c(n);n.w=o;n.ty=0;n.x=i.canvas.width+t*e;n.vx=5;n.statsd=!1}function c(t){t.th=f+Math.floor(Math.random()*(n.ctx.canvas.height-f-i)+1);t.bh=n.ctx.canvas.height-t.th-i;t.by=n.ctx.canvas.height-t.bh}function l(n,t,i,r,u,f,e,o){return!(t+r<f||t>f+o||n+i<u||n>u+e)}function v(){this.x=0;this.vx=0;this.ty=0;this.by=0;this.w=0;this.th=0;this.bh=0;this.scored=!1}var f=50,i=150,t=4,e=200,o=36,s,r,u;for(this.gateArray=[],this.gateTop=new Image,this.gateBottom=new Image,this.gateTop.src="img/gateTop.png",this.gateBottom.src="img/gateBottom.png",this.collision=!1,this.started=!1,s=this,r=0;r<t;r++)u=new v,h(u,r,n.ctx),this.gateArray.push(u);this.update=function(n){var u=n.assets[1],s=n.assets[3],h=n.assets[0],f,r;for(i=150-h.level*5,f=0;f<t;f++){if(r=this.gateArray[f],!this.collision&&r.x<n.ctx.canvas.width/2&&!r.scored&&(s.score++,r.scored=!0),this.started&&(r.x-=r.vx),!u.immune&&!this.collision&&r.x<n.ctx.canvas.width/2+u.w/2&&r.x>n.ctx.canvas.width/2-u.w/2-r.w&&(l(u.x,u.y,u.w,u.h,r.x,r.ty,r.w,r.th)||l(u.x,u.y,u.w,u.h,r.x,r.by,r.w,r.bh))&&(this.collision=!0,u.hit()),this.collision)for(f=0;f<t;f++)r=this.gateArray[f],r.x+=r.vx,r.vx=0;r.x<=0-r.w&&(r.scored=!1,r.x=n.ctx.canvas.width+(e-o),c(r))}};this.draw=function(n){for(var i,r=0;r<t;r++)i=this.gateArray[r],n.ctx.drawImage(this.gateTop,i.x,i.th-n.ctx.canvas.height),n.ctx.drawImage(this.gateBottom,i.x,i.by)};this.receiveKey=function(n,t){n===82?(this.collision=!1,this.started=!1,i=150,a(t.ctx)):n===70&&(this.started=!0)}}function Stats(n){this.score=0;this.x=n.ctx.canvas.width/2-240;this.y=5;this.highScore=0;var t=this;this.update=function(n){for(var r,i=n.assets[2],t=0;t<i.gateArray.length;t++)r=i.gateArray[t]};this.draw=function(n){var u=n.assets[0],i,r;n.ctx.font="36px arial";n.ctx.strokeStyle="#000";n.ctx.fillStyle="#FFF";n.ctx.textBaseline="top";i="FPS: "+n.fps()+" Lvl: "+u.level+" Score: "+t.score+" HS: "+t.highScore;r=n.ctx.measureText(i).width;t.x=n.ctx.canvas.width/2-Math.floor(r/2);n.ctx.fillText(i,t.x,t.y);n.ctx.strokeText(i,t.x,t.y)};this.receiveKey=function(n){n===82&&(t.highScore<t.score&&(t.highScore=t.score),t.score=0)}}function InfoScreen(n){var t="Press F to fly",i="Press R to restart";this.x=n.ctx.canvas.width/2-100;this.y=125;this.text=t;this.visible=!0;this.countdown=-1;this.update=function(n){var t=n.assets[1];t.dead?(this.text=i,this.visible=!0):this.countdown>0?this.countdown--:this.countdown===0&&(this.countdown=-1,this.visible=!1)};this.draw=function(n){if(this.visible){n.ctx.font="36px arial";n.ctx.strokeStyle="#000";n.ctx.fillStyle="red";var t=n.ctx.measureText(this.text).width;this.x=n.ctx.canvas.width/2-Math.floor(t/2);n.ctx.fillText(this.text,this.x,this.y);n.ctx.strokeText(this.text,this.x,this.y)}};this.receiveKey=function(n){n===70&&this.countdown<0?this.visible=!1:n===82&&(this.visible=!0,this.text=t)};this.toast=function(t,i){this.countdown=i*n.fps();this.text=t;this.visible=!0}}function bindEvent(n,t,i){n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent("on"+t,i)}var game;initGame();
/*
//# sourceMappingURL=game.min.js.map
*/